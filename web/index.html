<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Exoplanet KOI Classifier</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    h1 {
        font-size: 3rem;
        text-align: center;
        margin: 20px 0;
        font-weight: 700;
        text-shadow: 0 2px 6px rgba(0,0,0,0.8); 
      }
    * {
            box-sizing: border-box;
          }
    :root { --gap: 12px; }
    body  { 
      font-family: system-ui, Arial, sans-serif; 
      max-width: 1100px; 
      margin: 24px auto; 
      padding: 0 16px; 
      color: white; /* üîπ ca≈Çy tekst na bia≈Ço */
      background-image: url("tlo.png");
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
    }

    .desc {
  font-size: 0.9rem;
  color: #fff;   /* üîπ bia≈Çy */
  margin: 6px 0 10px;
  line-height: 1.25rem;
}
    .grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); 
            gap: var(--gap); 
          }
    .card 
          {
            display: flex;
            flex-direction: column;   /* pionowe u≈Ço≈ºenie */
            justify-content: space-between; /* rozdziela opis i input */
            height: 100%;             /* karta na pe≈ÇnƒÖ wysoko≈õƒá w gridzie */
            border: 1px solid #ddd;;
            border-radius: 12px; 
            padding: 12px;
          }

    .card input 
          {
            margin-top: auto;         /* wpycha input na d√≥≈Ç */
          }
    label { display: block; font-weight: 700; margin-bottom: 6px; }
    
    input {
            width: 100%;              /* zawsze na ca≈ÇƒÖ szeroko≈õƒá kontenera */
            box-sizing: border-box;   /* ≈ºeby padding/liczenie szeroko≈õci by≈Ço poprawne */
            padding: 8px;
            font-size: 1rem;
            border: 1px solid #ccc;
            border-radius: 6px;
            margin-bottom: 3px;
          }
    .btn { padding: 10px 16px; border: 0; border-radius: 10px; cursor: pointer; background: #111; color: #fff; }
    .btn:disabled { opacity: 0.6; cursor: not-allowed; }
    .text-block {
            background: rgba(0, 0, 0, 0.55); /* czarne t≈Ço z przezroczysto≈õciƒÖ */
            padding: 12px 16px;
            border-radius: 12px;
            display: inline-block;
            line-height: 1.5rem;
          }
    #result { margin-top: 16px; }
  </style>
</head>
<body>
  <div class="text-block">
  <h1>Exoplanet KOI Classifier</h1>
  <h1> <br></h1>
 <p><strong>Exoplanets</strong> are worlds that orbit stars beyond our Sun. In just a few decades we‚Äôve confirmed thousands of them with missions like <em>Kepler</em> and <em>TESS</em>, revealing a zoo of planetary types ‚Äî from hot Jupiters hugging their stars to compact multi-planet systems and rocky worlds in temperate orbits. Most are found by the <em>transit method</em>, where a tiny dip in starlight betrays a planet crossing the stellar disk.</p>

<h3>Why do they matter?</h3>
<ul>
  <li><strong>Origins:</strong> They test our theories of how planets and entire systems form and evolve.</li>
  <li><strong>Diversity:</strong> Strange architectures and sizes challenge ‚ÄúSolar-System-centric‚Äù assumptions.</li>
  <li><strong>Habitability:</strong> Some receive Earth-like stellar energy; a few may even host atmospheres with biosignatures.</li>
  <li><strong>Comparative worlds:</strong> By contrasting many systems, we learn what makes Earth‚Äîand life here‚Äîpossible.</li>
  <li><strong>New tools & data:</strong> Exoplanet surveys drive advances in telescopes, statistics, and machine learning.</li>
</ul>

<p><strong>This demo</strong> uses features from NASA‚Äôs Kepler Objects of Interest (KOI) catalog (e.g., transit depth, duration, stellar radius) to estimate whether a signal is a <em>planet candidate</em> or a <em>false positive</em>. Enter values below and click <em>PREDICT</em> to see class probabilities.</p>



  <p id="status">Loading metadata‚Ä¶</p>

  <div id="form" class="grid"></div>

  <div style="margin-top:16px;">
    <button id="predict" class="btn" disabled>PREDICT</button>
  </div>

  <div id="result" class="card" style="display:none;"></div>
  </div>

  <script>
    // If you serve frontend separately (e.g., http://127.0.0.1:8080), keep full URL:
    const API_BASE = "http://127.0.0.1:8000"; 
    // If you mounted static files in FastAPI and open http://127.0.0.1:8000/, you can use:
    // const API_BASE = "";

    let featureOrder = [];
    let classNames = [];
    let medians = {};

    // Human-friendly names and brief meanings for each feature.
    // Only shown for known keys; unknown keys will show the raw name.
    const DESCRIPTIONS = {
      koi_steff: {
        title: "Stellar Effective Temperature (K)",
        text: "Approximate surface temperature of the star in Kelvin. Hotter stars emit more energy, which increases a planet‚Äôs equilibrium temperature. Typical host stars in Kepler data: 3000‚Äì7000 K (Sun = 5778 K)."
      },
      koi_slogg: {
        title: "Stellar Surface Gravity (log g, cgs)",
        text: "Log10 of surface gravity (cm/s¬≤). Helps characterize the star‚Äôs size/class; affects stellar radius estimates and thus transit geometry. Main-sequence stars usually ~4.0‚Äì4.7; giants <3.5."
      },
      koi_srad: {
        title: "Stellar Radius (R‚òâ)",
        text: "Star radius in Solar radii. Larger stars cause shallower relative dips for the same planet size; needed to translate transit depth into planetary radius. Most host stars are 0.5‚Äì2 R‚òâ (Sun = 1.0 R‚òâ)."
      },
      ra: {
        title: "Right Ascension (deg)",
        text: "Sky coordinate (east‚Äìwest), in degrees. Positional metadata; not physically causal but part of the dataset record. Value between 0‚Äì360¬∞."
      },
      dec: {
        title: "Declination (deg)",
        text: "Sky coordinate (north‚Äìsouth), in degrees. Positional metadata; not physically causal but part of the dataset record. Value between ‚Äì90¬∞ and +90¬∞. "
      },
      koi_kepmag: {
        title: "Kepler Magnitude (mag)",
        text: "Brightness of the target in Kepler band. Fainter stars yield noisier light curves; can impact signal-to-noise. Typical stars: 9‚Äì16 mag."
      },
      koi_period: {
        title: "Orbital Period (days)",
        text: "Time for one orbit. Short periods often imply hotter planets; period with stellar mass sets orbital distance. Known exoplanets range from <1 day (hot Jupiters) to hundreds of days. Earth = 365 days."
      },
      koi_time0bk: {
        title: "Transit Epoch (BKJD)",
        text: "Reference time (Barycentric Kepler Julian Date) of a transit. Used for scheduling and phase folding; not directly causal for classification. Typical values vary 100‚Äì1600 BKJD."
      },
      koi_duration: {
        title: "Transit Duration (hours)",
        text: "How long the star dims during transit. With period and impact parameter, constrains orbital geometry. Common durations: 1‚Äì15 h, depending on orbit size and star radius."
      },
      koi_impact: {
        title: "Impact Parameter (0‚Äì1)",
        text: "How centrally the planet crosses the stellar disk (0=center, 1=edge). Affects transit duration/shape. Most values between 0‚Äì0.9."
      },
      koi_depth: {
        title: "Transit Depth (ppm)",
        text: "Drop in brightness in parts-per-million. Roughly proportional to (planet radius / star radius)¬≤; deeper ‚Üí larger planet. Small rocky planets: ~100‚Äì1000 ppm. Giant planets: thousands of ppm."
      },
      koi_model_snr: {
        title: "Transit Signal-to-Noise Ratio",
        text: "Strength of the transit signal vs. noise. Higher SNR increases confidence the signal is real. Valid detections usually SNR > 7; higher = more reliable."
      },
      koi_prad: {
        title: "Planetary Radius (R‚äï)",
        text: "Estimated planet radius in Earth radii. Derived from depth and stellar radius; informs planet class (e.g., Earth-size vs. Neptune-size).  Range: 0.5‚Äì20 R‚äï. Earth = 1, Neptune ~4, Jupiter ~11."
      },
      koi_teq: {
        title: "Planetary Equilibrium Temperature (K)",
        text: "Estimated temperature assuming no atmosphere. Higher values generally mean less hospitable conditions. Habitable-zone planets: 200‚Äì350 K. Hot Jupiters: 1000‚Äì2000 K."
      },
      koi_insol: {
        title: "Insolation Flux (Earth=1)",
        text: "Stellar energy received relative to Earth. Near 1 suggests Earth-like irradiation; relates to habitability zone. Habitable planets: ~0.3‚Äì2.0. Hot planets often >>10."
      }
    };

    function renderField(container, key, medianValue) {
      const info = DESCRIPTIONS[key] || { title: key, text: "Feature from the KOI dataset." };
      const wrap = document.createElement("div");
      wrap.className = "card";

      const label = document.createElement("label");
      label.setAttribute("for", `feat_${key}`);
      label.textContent = info.title;

      const desc = document.createElement("div");
      desc.className = "desc";
      desc.textContent = info.text;

      const input = document.createElement("input");
      input.type = "number";
      input.step = "any";
      input.id = `feat_${key}`;
      input.value = medianValue;
      // zamiast wpisywaƒá medianƒô, pokazujemy jƒÖ jako placeholder
      if (medianValue !== undefined && medianValue !== null) {
        input.placeholder = `median = ${medianValue}`;
      }

      wrap.appendChild(label);
      wrap.appendChild(desc);
      wrap.appendChild(input);
      container.appendChild(wrap);
    }


    async function loadMeta() {
      const status = document.getElementById("status");
      const btn = document.getElementById("predict");
      try {
        const res = await fetch(`${API_BASE}/metadata`);
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const meta = await res.json();

        featureOrder = meta.feature_order || [];
        classNames   = meta.class_names || [];
        medians      = meta.medians || {};  // <-- needs to be provided by backend

        const form = document.getElementById("form");
        form.innerHTML = "";

        featureOrder.forEach((f) => {
          renderField(form, f, medians[f]);
        });

        status.textContent = "Enter feature values and click PREDICT.";
        btn.disabled = false;
      } catch (e) {
        status.textContent = "Failed to load /metadata. Is the backend running and returning medians?";
        console.error(e);
      }
    }

    async function predict() {
      const data = {};
      featureOrder.forEach((f) => {
        const el = document.getElementById(`feat_${f}`);
        const v = el.value;
        if (v !== "") {
            data[f] = parseFloat(v);
          } else if (medians[f] !== undefined) {
            data[f] = medians[f];  // je≈õli puste, wstaw medianƒô
          }
        });

      const box = document.getElementById("result");
      box.style.display = "block";
      box.textContent = "Computing‚Ä¶";

      try {
        const res = await fetch(`${API_BASE}/predict`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ data })
        });
        const out = await res.json();
        if (!res.ok) throw new Error(out.detail || JSON.stringify(out));

        const probs = out.probabilities || {};
        const sorted = Object.entries(probs).sort((a,b)=>b[1]-a[1]);
        box.innerHTML = `
          <h3>Prediction: ${out.prediction}</h3>
          <p>Class probabilities:</p>
          <ul>${sorted.map(([k,v]) => `<li>${k}: ${(v*100).toFixed(2)}%</li>`).join("")}</ul>
        `;
      } catch (e) {
        box.innerHTML = `<strong>Error:</strong> ${e.message}`;
        console.error(e);
      }
    }

    document.getElementById("predict").addEventListener("click", predict);
    loadMeta();
  </script>
</body>
</html>
